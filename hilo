using System.Globalization;
using System.Text;

public static class TextoHelper
{
    public static string LimpiarCaracteresEspeciales(string? texto)
    {
        if (string.IsNullOrWhiteSpace(texto))
            return string.Empty;

        // 1. Normaliza para separar letras de acentos
        var textoNormalizado = texto.Normalize(NormalizationForm.FormD);

        var sb = new StringBuilder();

        foreach (var c in textoNormalizado)
        {
            var categoria = CharUnicodeInfo.GetUnicodeCategory(c);

            // 2. Ignorar los acentos (NonSpacingMark)
            if (categoria == UnicodeCategory.NonSpacingMark)
                continue;

            // 3. Solo dejamos letras, n√∫meros y espacio
            if (char.IsLetterOrDigit(c) || char.IsWhiteSpace(c))
            {
                sb.Append(c);
            }
            // Si quieres permitir guion o guion bajo, descomenta:
            // else if (c == '-' || c == '_')
            // {
            //     sb.Append(c);
            // }
        }

        // 4. Volvemos a normalizar el resultado
        return sb.ToString().Normalize(NormalizationForm.FormC);
    }
}