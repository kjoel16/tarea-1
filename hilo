@Service
public class ConsultaService {

    private final As400Client as400Client = new As400Client();

    public ConsultaResponse procesarTrama(String trama) {

        ConsultaResponse response = new ConsultaResponse();

        try {
            String cuenta = trama.split("=")[1];

            String resultado = as400Client.llamarPrograma(cuenta);

            response.setCodigo("00");
            response.setMensaje("Respuesta AS400: " + resultado);
            response.setCuenta(cuenta);

        } catch (Exception e) {
            response.setCodigo("99");
            response.setMensaje("Error AS400: " + e.getMessage());
        }

        return response;
    }
}