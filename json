@Service
public class ClienteService {

    @Autowired
    private DataSource dataSource;

    public DatosClienteDTO consultarDatosCliente(String cuenta) {

        DatosClienteDTO dto = new DatosClienteDTO();
        String sql = "{CALL KJOELQDD.SP_DATOS_CLIENTE_CUENTA(?, ?, ?, ?, ?, ?, ?)}";

        try (Connection conn = dataSource.getConnection();
             CallableStatement cs = conn.prepareCall(sql)) {

            cs.setString(1, cuenta);

            cs.registerOutParameter(2, Types.CHAR);     
            cs.registerOutParameter(3, Types.CHAR);     
            cs.registerOutParameter(4, Types.VARCHAR);  
            cs.registerOutParameter(5, Types.VARCHAR);  
            cs.registerOutParameter(6, Types.VARCHAR);  
            cs.registerOutParameter(7, Types.VARCHAR);  

            cs.execute();

            dto.setDmstat(cs.getString(2));
            dto.setCunbr(cs.getString(3));
            dto.setCuna1(cs.getString(4));
            dto.setTelefono(cs.getString(5));
            dto.setIdentidad(cs.getString(6));
            dto.setEmail(cs.getString(7));

        } catch (SQLException e) {
            throw new RuntimeException(
                "Error consultando datos del cliente para la cuenta: " + cuenta, e
            );
        }

        return dto;
    }
}