package com.tu.paquete.connection;

import com.ibm.as400.access.AS400;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.sql.Connection;
import java.sql.DriverManager;

@Service
public class As400ConnectionService {

    @Autowired
    private AS400Properties properties;

    // ðŸ”µ TU MÃ‰TODO ACTUAL (NO TOCAR)
    public AS400 getAs400() {

        try {
            AS400 as400 = new AS400(
                    properties.getHost(),
                    properties.getUser(),
                    properties.getPassword()
            );

            as400.connectService(AS400.COMMAND);

            System.out.println("Conexion exitosa al AS400");

            return as400;

        } catch (Exception e) {
            throw new RuntimeException("Error conectando al AS400", e);
        }
    }

    // ðŸŸ¢ MÃ‰TODO NUEVO PARA SP (EL IMPORTANTE)
    public Connection getJdbcConnection() throws Exception {

        String url = "jdbc:as400://" + properties.getHost()
                + ";naming=system"
                + ";libraries=KJOELQDD";

        return DriverManager.getConnection(
                url,
                properties.getUser(),
                properties.getPassword()
        );
    }
}