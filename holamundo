List<string> sqlInsertRows = new List<string>();

string fechaActual = DateTime.Now.ToString("yyyy-MM-dd-HH.mm.ss.ffffff");
string processingTime = $"{_appTimer.Elapsed.Minutes}m {_appTimer.Elapsed.Seconds}s";

// Datos del encabezado del request
string hUserId = request.Header.HUserId;
string hProvider = request.Header.HProvider;
string hSessionId = request.Header.HSessionId;
string hClientIp = request.Header.HClientIp;
string responseId = Guid.NewGuid().ToString();
string statusCode = "200";
string message = "Consulta Exitosa";
string traceId = "trace-001";
string httpCode = "200";
string systemMsg = "OK";
string errorMsg = "";

int indexBalance = 0;
foreach (var balance in consultarBuzonResponse.Balances.Balance)
{
    foreach (var currency in balance.Currencys)
    {
        foreach (var denomination in currency.Denominations.Denomination)
        {
            string row = $@"
SELECT '{hUserId}', '{hProvider}', '{hSessionId}', '{hClientIp}', '{fechaActual}',
       '{responseId}', '{fechaActual}', '{processingTime}', '{statusCode}', '{message}',
       '{traceId}', '{httpCode}', '{systemMsg}', '{errorMsg}',
       '{currency.Code}', '{consultarBuzonResponse.CountryId}', {indexBalance}, '{balance.BalanceType}',
       '{balance.DeviceCode}', '{balance.DateBalance}', '{balance.DeviceCode}', 0, '{currency.Code}',
       {denomination.Value}, {denomination.Quantity}, {denomination.Amount}, '{denomination.Type}',
       '', '', '', '', '', '', ''";
            sqlInsertRows.Add(row.Trim());
        }
    }
    indexBalance++;
}

foreach (var trx in consultarBuzonResponse.Transaccion.Transaction)
{
    foreach (var currency in trx.currency)
    {
        foreach (var denomination in currency.Denominations.Denomination)
        {
            string row = $@"
SELECT '{hUserId}', '{hProvider}', '{hSessionId}', '{hClientIp}', '{fechaActual}',
       '{responseId}', '{fechaActual}', '{processingTime}', '{statusCode}', '{message}',
       '{traceId}', '{httpCode}', '{systemMsg}', '{errorMsg}',
       '{currency.Code}', '{consultarBuzonResponse.CountryId}', 0, '',
       '{trx.DeviceCode}', '{trx.DateBalance}', '', 0, '{currency.Code}',
       {denomination.Value}, {denomination.Quantity}, {denomination.Amount}, '{denomination.Type}',
       '{trx.ActualId}', '{trx.TransactonDate}', '{trx.ServicePoint}', '{trx.ReceiptNumber}',
       '{currency.CashierId}', '{currency.CashierName}', '{trx.TipoTrans}'";
            sqlInsertRows.Add(row.Trim());
        }
    }
}