using System.Text.RegularExpressions;
using System.Text;

public static string LimpiarConRegexMatch(string input)
{
    if (string.IsNullOrWhiteSpace(input)) return "";

    // Lista blanca de caracteres permitidos (ajusta según lo que el AS400 soporte)
    string patron = @"[a-zA-Z0-9\s\.,;:@#\-_!?()]+";

    var matches = Regex.Matches(input, patron);
    var sb = new StringBuilder();

    foreach (Match match in matches)
    {
        sb.Append(match.Value);
    }

    // Reemplaza espacios múltiples por uno
    string limpio = Regex.Replace(sb.ToString(), @"\s+", " ");
    return limpio.Trim();
}