@startuml
title Flujo completo - API Spring Boot + AS400 + Deploy en Linux con Nginx

actor Developer
participant "PC Desarrollo\n(Spring Boot)" as DEV
participant "Windows Server\n(5.246)" as WIN
participant "AS400" as AS400
participant "Linux Server\n(5.148)" as LINUX
participant "Nginx" as NGINX
participant "Cliente HTTP" as CLIENT

== Desarrollo y Debug ==

Developer -> DEV : Crear API Spring Boot
Developer -> DEV : Configurar conexión AS400
Developer -> DEV : Crear DTOs y TransaccionService
Developer -> DEV : Debug paso a paso

DEV -> AS400 : ProgramCall(params[])
AS400 --> DEV : Respuesta (codError, descError)

Developer -> DEV : Validar parámetros PI RPG
Developer -> DEV : Ajustar tamaños AS400Text
Developer -> DEV : Confirmar conexión exitosa

== Empaquetado ==

Developer -> DEV : mvn clean package
DEV -> DEV : Genera JAR (target/*.jar)

Developer -> WIN : Copiar proyecto
WIN -> WIN : Ejecutar JAR de prueba
WIN -> AS400 : Llamar programa RPG
AS400 --> WIN : Respuesta correcta

== Transferencia de JAR ==

Developer -> DEV : Descargar JAR a PC
DEV -> LINUX : scp API.jar /opt/

== Despliegue en Linux ==

Developer -> LINUX : SSH login
Developer -> LINUX : Instalar JDK 21
Developer -> LINUX : Ejecutar\njava -jar API.jar &

LINUX -> LINUX : API corre en puerto 8080

== Configuración Nginx ==

Developer -> NGINX : Configurar reverse proxy
NGINX -> LINUX : Redirigir a localhost:8080

== Consumo final ==

CLIENT -> NGINX : HTTP Request
NGINX -> LINUX : Forward request
LINUX -> AS400 : ProgramCall(params)
AS400 --> LINUX : Respuesta
LINUX --> NGINX : JSON Response
NGINX --> CLIENT : JSON Response

@enduml